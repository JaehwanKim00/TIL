# PIVOT, UNPIVOT
<a href="https://www.youtube.com/watch?v=FINRIH6Bmq0/">링크</a>

## 요약

PIVOT,UNPIVOT을 하는 이유는 데이러를 가시성있게 표현하기 위해서\
예를 들어 GROUP BY를 진행해서 데이터를 나타내며 사실 우리가 보기에\
쉬운 형식이 아님\

PIVOT : 행을 열로 바꿈. 지정된 칼럼의 각 행 속성값들이 새로운 칼럼 헤더가 되고 이에 맞게 전체 속성값들이 재배치

UNPIVOT : PIVOT과 반대로 열을 행으로 바꿈. 칼럼 헤더들이 한 칼럼의 각 행 속성값이 되고 이에 맞게 전체 속성값들이 재배치

![PIVOT_X](/SQL/img/20241125_133317.png)


![PIVOT_O](/SQL/img/20241125_133356.png)

위 사진보다 아래 사진이 더 데이터를 보는데 가시성이 있음

![UNPIVOT](/SQL/img/20241125_134950.png)

UNPIVOT은 칼럼값을 행으로


# 문제1

<a href="https://www.hackerrank.com/challenges/occupations/problem/">링크</a>

## 작성한 코드
```sql
WITH Rank_Occupations AS (
    SELECT
        Name,
        Occupation,
        ROW_NUMBER() OVER (PARTITION BY Occupation ORDER BY Name) AS RowNum
    FROM OCCUPATIONS
)
SELECT
    MAX(CASE WHEN Occupation = 'Doctor' THEN Name ELSE NULL END) AS Doctor,
    MAX(CASE WHEN Occupation = 'Professor' THEN Name ELSE NULL END) AS Professor,
    MAX(CASE WHEN Occupation = 'Singer' THEN Name ELSE NULL END) AS Singer,
    MAX(CASE WHEN Occupation = 'Actor' THEN Name ELSE NULL END) AS Actor
FROM Rank_Occupations
GROUP BY RowNum
ORDER BY RowNum
```

## 결과 및 설명
![스크린샷](/SQL/img/20241125_144009.png)

먼저 with문을 이용하여 한 직업군 내에서 이름 순으로 순서를 매긴 임시테이블을 생성\
ROW_NUMBER을 이용하여 각 이름에 중복없이 고유한 순서를 매김\

